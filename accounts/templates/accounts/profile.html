{% extends "base.html" %}
{% load static %}

{% block title %}{{ profile_user.name|default:profile_user.username }}'s Profile{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-container">
    <!-- Profile Header -->
    <div class="profile-header">
        <div class="profile-header-content">
            <div class="profile-avatar-wrapper">
                <img src="{{ profile_user.avatar.url|default:'/media/avatars/default/avatar.png' }}" 
                     alt="{{ profile_user.username }}" 
                     class="profile-avatar">
            </div>
            <div class="profile-info">
                <h1>{{ profile_user.name|default:profile_user.username }}</h1>
                <p class="username">@{{ profile_user.username }}</p>
            </div>
        </div>
    </div>

    <!-- Profile Body -->
    <div class="profile-body">
        <!-- Statistics -->
        <div class="profile-stats">
            <div class="stat-card">
                <p class="stat-value">{{ posts.count }}</p>
                <p class="stat-label">Posts</p>
            </div>
            <div class="stat-card">
                <p class="stat-value">{{ profile_user.date_joined|date:"M Y" }}</p>
                <p class="stat-label">Member Since</p>
            </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs profile-tabs" id="profileTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="posts-tab" data-bs-toggle="tab" 
                        data-bs-target="#posts" type="button" role="tab" 
                        aria-controls="posts" aria-selected="true">
                    <i class="bi bi-grid-3x3"></i> Posts
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="about-tab" data-bs-toggle="tab" 
                        data-bs-target="#about" type="button" role="tab" 
                        aria-controls="about" aria-selected="false">
                    <i class="bi bi-person"></i> About
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="profileTabContent">
            <!-- Posts Tab -->
            <div class="tab-pane fade show active" id="posts" role="tabpanel" aria-labelledby="posts-tab">
                {% if posts %}
                <div class="posts-grid">
                    {% for post in posts %}
                    <div class="post-card-profile" onclick="window.location.href='{% url 'blog_detail' post.slug %}'">
                        {% if post.image %}
                        <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-card-image">
                        {% else %}
                        <div class="post-card-image"></div>
                        {% endif %}
                        <div class="post-card-content">
                            <h3 class="post-card-title">{{ post.title }}</h3>
                            <p class="post-card-description">{{ post.description|truncatewords:20 }}</p>
                            <div class="post-card-meta">
                                <span class="post-card-category">{{ post.category.name }}</span>
                                <span><i class="bi bi-calendar"></i> {{ post.created_at|date:"M d, Y" }}</span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="bi bi-file-earmark-text"></i>
                    <h3>No posts yet</h3>
                    <p>
                        {% if is_own_profile %}
                        You haven't created any posts yet. Start sharing your thoughts!
                        {% else %}
                        {{ profile_user.username }} hasn't posted anything yet.
                        {% endif %}
                    </p>
                </div>
                {% endif %}
            </div>

            <!-- About Tab -->
            <div class="tab-pane fade" id="about" role="tabpanel" aria-labelledby="about-tab">
                <div class="about-section">
                    <div class="about-item">
                        <i class="bi bi-person-circle"></i>
                        <div class="about-item-content">
                            <div class="about-item-label">Username</div>
                            <div class="about-item-value">{{ profile_user.username }}</div>
                        </div>
                    </div>
                    {% if profile_user.name %}
                    <div class="about-item">
                        <i class="bi bi-card-text"></i>
                        <div class="about-item-content">
                            <div class="about-item-label">Full Name</div>
                            <div class="about-item-value">{{ profile_user.name }}</div>
                        </div>
                    </div>
                    {% endif %}
                    {% if is_own_profile or profile_user.email %}
                    <div class="about-item">
                        <i class="bi bi-envelope"></i>
                        <div class="about-item-content">
                            <div class="about-item-label">Email</div>
                            <div class="about-item-value">{{ profile_user.email }}</div>
                        </div>
                    </div>
                    {% endif %}
                    <div class="about-item">
                        <i class="bi bi-calendar-check"></i>
                        <div class="about-item-content">
                            <div class="about-item-label">Joined</div>
                            <div class="about-item-value">{{ profile_user.date_joined|date:"F d, Y" }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

